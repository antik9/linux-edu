<!-- README.html --> 
<script src="https://rawcdn.githack.com/oscarmorrison/md-page/master/md-page.js">
</script>
<noscript>

## IP2W api (ip to weather)

* [1.Install](#install)<br/>
    - [1.1 Docker](#install_docker)<br/>
    - [1.2 RPM Package](#install_rpm)<br/>
* [2.Start](#start)<br/>
    - [2.1 Docker](#start_docker)<br/>
    - [2.2 RPM Package](#start_rpm)<br/>
* [3.Requests](#requests)

<h2 id="install"> Install </h2>
<h3 id="install_docker"> Docker </h3>

To download docker image add exception for otus.antik.ml host to your docker service
```
...
--insecure-registry otus.antik.ml
...
```

Pull image
```
docker pull otus.antik.ml/ip2w
```

<h3 id="install_rpm"> RPM package </h3>

To enable uwsgi-python install epel-release.
```
>>> yum install epel-release
```

Add repo to your repolist.
```
>>> cat > /etc/yum.repos.d/antik.repo << EOF
[antik]
name=antik RPM Repository
baseurl=http://otus.antik.ml/centos
gpgcheck=0
enabled=1
EOF
```
Install with yum.

```
>>> yum install ip2w
```

<h2 id="start"> Start </h3>

<h3 id="start_docker"> Docker </h3>

This application needed token for work with **openweathermap.org**. You should add token to your environment with **OPEN_WEATHER_TOKEN** variable
```
>>> docker run -d -p 8080:80 --name ip2w -e OPEN_WEATHER_TOKEN=<your_token>  otus.antik.ml/ip2w
```

<h3 id="start_rpm"> RPM package </h3>

Add ```"OPEN_WEATHER_TOKEN": "{your_token}"``` to your __*/usr/local/etc/config_ip2w.json*__

To run system service
```
>>> sudo service ip2w start
```

<h2 id="requests"> Requests </h2>

To make request to the service you can use curl utility.
```
>>> curl localhost:{your_nginx_port}/ip2w/46.48.185.235
{"city": "Yakutsk", "conditions": "ясно", "temp": "+4.00"}
```

